<div id="resume-dashboard">
    <!-- Professional Summary Section -->
    <div class="summary-stats-section">
        <% 
        // Calculate stats
        let companies = new Set();
        let oldestDate = new Date();
        let yearsExp = 0;
        
        if (sections.experience && sections.experience.length > 0) {
            sections.experience.forEach(job => {
                if (job.subtitle) companies.add(job.subtitle.split(' - ')[0]);
                if (job.date_range) {
                    const dateMatch = job.date_range.match(/(\d{4})/);
                    if (dateMatch) {
                        const year = parseInt(dateMatch[1]);
                        const jobDate = new Date(year, 0, 1);
                        if (jobDate < oldestDate) oldestDate = jobDate;
                    }
                }
            });
            yearsExp = new Date().getFullYear() - oldestDate.getFullYear();
        }
        %>
        <div class="summary-stats" 
             data-years="<%= yearsExp > 0 ? yearsExp : 1 %>"
             data-companies="<%= companies.size %>"
             data-roles="<%= sections.experience ? sections.experience.length : 0 %>">
            <div class="stat-item">
                <div class="stat-number" id="years-exp">0</div>
                <div class="stat-label">Years Experience</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="companies-count">0</div>
                <div class="stat-label">Companies</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="roles-count">0</div>
                <div class="stat-label">Roles</div>
            </div>
        </div>
        
        <!-- Download Button -->
        <a href="/images/Nadav Moskow - Resume.pdf" target="_blank" download>
            <button class="download-btn">
                <span>üìÑ</span>
                Download PDF Resume
            </button>
        </a>
    </div>

    <!-- Dashboard Grid -->
    <div class="dashboard-grid">
        <!-- Professional Experience Card -->
        <div class="dashboard-card" data-card="experience" id="Experience">
            <div class="card-header clickable-header">
                <div class="header-content">
                    <span class="card-icon">üíº</span>
                    <h2 class="card-title">Experience</h2>
                </div>
                <button class="collapse-toggle" aria-label="Toggle section">+</button>
            </div>
            
            <div class="card-divider"></div>
            
            <div class="card-content">
                <!-- Job List -->
                <div class="experience-list">
                    <% if (sections.experience && sections.experience.length > 0) { %>
                        <% sections.experience.forEach((job, index) => { %>
                            <div class="job-item collapsible-job">
                                <div class="job-header" data-job="<%= index %>">
                                    <div class="job-header-content">
                                        <h3 class="job-title"><%= job.title %></h3>
                                        <div class="job-meta-centered">
                                            <% if (job.subtitle) { %>
                                                <span class="job-company"><%= job.subtitle %></span>
                                            <% } %>
                                            <% if (job.date_range) { %>
                                                <span class="job-dates"><%= job.date_range %></span>
                                            <% } %>
                                        </div>
                                    </div>
                                    <button class="job-toggle" aria-label="Toggle job details">+</button>
                                </div>
                                <div class="job-content" id="job-<%= index %>">
                                    <div class="job-description">
                                        <%- job.description %>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    <% } %>
                </div>
            </div>
            
            <div class="card-hover-overlay">
                <span class="view-details-text">View Details ‚Üí</span>
            </div>
        </div>

        <!-- Skills & Technologies Card -->
        <div class="dashboard-card" data-card="skills" id="Skills">
            <div class="card-header clickable-header">
                <div class="header-content">
                    <span class="card-icon">üõ†Ô∏è</span>
                    <h2 class="card-title">Skills & Tools</h2>
                </div>
                <button class="collapse-toggle" aria-label="Toggle section">+</button>
            </div>
            
            <div class="card-divider"></div>
            
            <div class="card-content">
                <% if (sections.skills && sections.skills.length > 0) { %>
                    <div class="skills-sections">
                        <% sections.skills.forEach((skill, index) => { %>
                            <div class="skill-section">
                                <div class="skill-header clickable-skill-header" data-skill="<%= index %>">
                                    <h3 class="skill-category"><%= skill.title %></h3>
                                    <button class="skill-toggle" data-skill="<%= index %>" aria-label="Toggle skill section">+</button>
                                </div>
                                <div class="skill-content" id="skill-<%= index %>">
                                    <%- skill.description %>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } %>
            </div>
            
            <div class="card-hover-overlay">
                <span class="view-details-text">View Details ‚Üí</span>
            </div>
        </div>

        <!-- Achievements & Certifications Card -->
        <div class="dashboard-card" data-card="achievements" id="Courses">
            <div class="card-header clickable-header">
                <div class="header-content">
                    <span class="card-icon">üèÜ</span>
                    <h2 class="card-title">Courses & Achievements</h2>
                </div>
                <button class="collapse-toggle" aria-label="Toggle section">+</button>
            </div>
            
            <div class="card-divider"></div>
            
            <div class="card-content">
                <% if (sections.courses && sections.courses.length > 0) { %>
                    <div class="achievements-list">
                        <% sections.courses.forEach(course => { %>
                            <div class="achievement-item">
                                <div class="achievement-icon">üéØ</div>
                                <div class="achievement-content">
                                    <h3 class="achievement-title"><%= course.title %></h3>
                                    <% if (course.subtitle) { %>
                                        <p class="achievement-subtitle"><%= course.subtitle %></p>
                                    <% } %>
                                    <div class="achievement-description">
                                        <%- course.description %>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } %>
            </div>
            
            <div class="card-hover-overlay">
                <span class="view-details-text">View Details ‚Üí</span>
            </div>
        </div>

        <!-- Education Card -->
        <div class="dashboard-card" data-card="education" id="Education">
            <div class="card-header clickable-header">
                <div class="header-content">
                    <span class="card-icon">üéì</span>
                    <h2 class="card-title">Education</h2>
                </div>
                <button class="collapse-toggle" aria-label="Toggle section">+</button>
            </div>
            
            <div class="card-divider"></div>
            
            <div class="card-content">
                <% if (sections.education && sections.education.length > 0) { %>
                    <div class="education-list">
                        <% sections.education.forEach(edu => { %>
                            <div class="education-item">
                                <h3 class="education-degree"><%= edu.title %></h3>
                                <p class="education-school"><%= edu.subtitle %></p>
                                <p class="education-dates"><%= edu.date_range %></p>
                                <div class="education-description">
                                    <%- edu.description %>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } %>
            </div>
            
            <div class="card-hover-overlay">
                <span class="view-details-text">View Details ‚Üí</span>
            </div>
        </div>
    </div>
    
    <!-- Resume Section Modal -->
    <div id="resume-modal" class="resume-modal">
        <div class="resume-modal-content">
            <button class="modal-close" aria-label="Close modal">&times;</button>
            <div class="modal-header">
                <span class="modal-icon"></span>
                <h2 class="modal-title"></h2>
            </div>
            <div class="modal-body">
                <!-- Content will be dynamically inserted here -->
            </div>
        </div>
    </div>
</div>

<script src="/js/resume-modal.js?v=1"></script>
<script>
// Ensure dashboard is re-initialized after modal loads
document.addEventListener('DOMContentLoaded', function() {
    // Small delay to ensure modal script executes
    setTimeout(function() {
        if (typeof initDashboard === 'function') {
            initDashboard();
        }
    }, 100);
});

// Also handle if DOM is already loaded
if (document.readyState !== 'loading') {
    setTimeout(function() {
        if (typeof initDashboard === 'function') {
            initDashboard();
        }
    }, 100);
}
</script>
